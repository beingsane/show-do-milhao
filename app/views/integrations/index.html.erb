<link rel="stylesheet" href="/app/assets/stylesheets/chosen.min.css"/>

<div class="col-md-12 col-md-offset-0">
  <div class="portlet">
    <div class="page-header">
      <h1>Junte tudo!</h1>
      <%= form_tag juntar_path do %>
          <span class="text-info">
            Começe escolhendo o assunto:
          </span>
          <%= select_tag :subject_id,
                         options_from_collection_for_select(@subjects, :id, :title, params[:subject_id]),
                         include_blank: true, class: 'form-control' %>

      <% end %>
      <br />
        <span class="text-info">
            Agora selecione a questão: <br />
        </span>
      <%= select_tag :question_id, options_from_collection_for_select(@questions, :id, :description,
                                                                      params[:question_id]),
                     class: 'chosen-select form-control', :'data-placeholder' => 'Escreva algo
                     para filtrar...' %>
    </div>
    <div class="portlet-content row">

      <div class="col-md-12">
        <h3>Respostas</h3>
        <div class="table-responsive">
          <table class="table table-hover table-condensed">
            <thead>
            <tr>
              <th>Título</th>
              <th>Assunto</th>
              <th colspan="3">Opções</th>
            </tr>
            </thead>

            <tbody>
            <% @answers.each do |answer| %>
                <tr>
                  <td><%= answer.title %></td>
                  <td><%= answer.subject.title %></td>
                  <td><%= link_to 'Exibir', answer, class: 'btn btn-primary center-block white' %></td>
                  <td>
                    <%= link_to 'Alterar', edit_answer_path(answer),
                                class: 'btn btn-primary center-block white' %>
                  </td>
                  <td>
                    <%= link_to 'Deletar', answer, method: :delete,
                                data: { confirm: 'Tem certeza?' },
                                class: 'btn btn-danger center-block white' %>
                  </td>
                </tr>
            <% end %>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="/app/assets/javascripts/chosen.jquery.min.js" type="text/javascript"></script>
<script>
    $(function(){
        $('#subject_id').on('change', function() {
            $('form').submit();
        });
    });

    $('.chosen-select').chosen();
</script>